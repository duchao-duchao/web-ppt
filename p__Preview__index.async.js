"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[879],{54111:function(we,M,s){s.r(M),s.d(M,{default:function(){return fe}});var ae=s(64599),B=s.n(ae),ie=s(15009),k=s.n(ie),le=s(99289),F=s.n(le),oe=s(5574),C=s.n(oe),c=s(67294),ue=s(16864),se=s(45322),G=s(85893),ce=function(){var A=(0,ue.L)(),R=A.slides,j=A.setCurrentSlideIndex,de=A.currentSlideIndex,z=A.loadState,ve=(0,c.useState)(de),H=C()(ve,2),v=H[0],U=H[1],pe=(0,c.useState)(0),X=C()(pe,2),w=X[0],D=X[1],$=(0,c.useRef)(!1),S=(0,c.useRef)(null),O=(0,c.useRef)([]),b=(0,c.useRef)(!1);(0,c.useEffect)(function(){var r=localStorage.getItem("presentation-for-preview");r&&z(JSON.parse(r))},[z]),(0,c.useEffect)(function(){j(v),D(0),q()},[v,j]),(0,c.useEffect)(function(){var r=function(){var n=F()(k()().mark(function e(){return k()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,document.fullscreenElement){t.next=4;break}return t.next=4,document.documentElement.requestFullscreen();case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}},e,null,[[0,6]])}));return function(){return n.apply(this,arguments)}}();r()},[]);var Y=function(){v>0&&U(v-1)},N=function(){v<R.length-1&&U(v+1)};(0,c.useEffect)(function(){var r=function(e){e.key==="ArrowUp"||e.key==="PageUp"?(e.preventDefault(),Y()):(e.key==="ArrowDown"||e.key==="PageDown")&&(e.preventDefault(),N())};return window.addEventListener("keydown",r),function(){return window.removeEventListener("keydown",r)}},[v,R.length]);var l=R[v],W=800,J=480,me=(0,c.useState)(1),Z=C()(me,2),ye=Z[0],ge=Z[1];(0,c.useEffect)(function(){var r=function(){var e=window.innerWidth,o=window.innerHeight,t=Math.min(e/W,o/J);ge(t)};return r(),window.addEventListener("resize",r),function(){return window.removeEventListener("resize",r)}},[]);var he=function(n){var e,o,t,d=n.effect,u=n.options,m=n.kind,i=(e=u.distancePx)!==null&&e!==void 0?e:120,f=(o=u.direction)!==null&&o!==void 0?o:"bottom",I=(t=u.rotateDeg)!==null&&t!==void 0?t:360;switch(d){case"appear":case"fade":return[{opacity:0},{opacity:1}];case"disappear":return[{opacity:1},{opacity:0}];case"zoomIn":return[{transform:"scale(0.8)",opacity:.5},{transform:"scale(1)",opacity:1}];case"zoomOut":return[{transform:"scale(1)",opacity:1},{transform:"scale(0.8)",opacity:.5}];case"flyIn":{var h=f==="left"?"translateX(-".concat(i,"px)"):f==="right"?"translateX(".concat(i,"px)"):f==="top"?"translateY(-".concat(i,"px)"):"translateY(".concat(i,"px)");return[{transform:h,opacity:0},{transform:"translate(0,0)",opacity:1}]}case"flyOut":{var g=f==="left"?"translateX(-".concat(i,"px)"):f==="right"?"translateX(".concat(i,"px)"):f==="top"?"translateY(-".concat(i,"px)"):"translateY(".concat(i,"px)");return[{transform:"translate(0,0)",opacity:1},{transform:g,opacity:0}]}case"spin":{var y=I||360;return[{transform:"rotate(0deg)"},{transform:"rotate(".concat(y,"deg)")}]}case"bounce":return[{transform:"scale(1)",offset:0},{transform:"scale(1.15)",offset:.4},{transform:"scale(0.95)",offset:.7},{transform:"scale(1)",offset:1}];case"wipe":return[{opacity:0},{opacity:1}];default:return m==="exit"?[{opacity:1},{opacity:0}]:[{opacity:0},{opacity:1}]}},Q=function(n){var e=document.getElementById("ppt-main-canvas"),o=document.getElementById("ppt-thumb-canvas-".concat(v)),t="#ppt-el-".concat(n);return(e==null?void 0:e.querySelector(t))||(o==null?void 0:o.querySelector(t))||null},V=function(n,e,o){var t,d;if(!n)return null;var u=n.elements.find(function(i){return i.id===e}),m=(t=u==null||(d=u.animations)===null||d===void 0?void 0:d.find(function(i){return i.id===o}))!==null&&t!==void 0?t:null;return m||null},q=function(){var n=l;if(!(!n||!Array.isArray(n.timeline))){console.log("applyInitialEntranceGating for slide",n.id);var e=n.timeline.flatMap(function(f){return f.animationRefs}),o=new Set,t=B()(e),d;try{for(t.s();!(d=t.n()).done;){var u=d.value;if(!o.has(u.elementId)){var m=V(n,u.elementId,u.animationId);if(m&&m.kind==="entrance"){var i=Q(u.elementId);if(!i)continue;i.style.opacity="0",i.setAttribute("data-pre-enter","true"),o.add(u.elementId)}}}}catch(f){t.e(f)}finally{t.f()}}},T=function(){O.current.forEach(function(n){try{n.cancel()}catch(e){}}),O.current=[],b.current=!1},_=function(){var n=document.getElementById("ppt-thumb-canvas-".concat(v))||document.getElementById("ppt-main-canvas");if(n&&n.getAnimations)try{n.getAnimations().forEach(function(e){return e.cancel()})}catch(e){}},P=function(){S.current&&(window.clearTimeout(S.current),S.current=null)},x=function(){var r=F()(k()().mark(function n(){var e,o,t,d,u,m,i,f,I,h,g,y,L,ne,te,re,E,K;return k()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=l==null||(e=l.timeline)===null||e===void 0?void 0:e[w],!(!l||!t)){a.next=3;break}return a.abrupt("return");case 3:P(),T(),$.current=!1,b.current=!0,d=[],u=B()(t.animationRefs),a.prev=9,u.s();case 11:if((m=u.n()).done){a.next=24;break}if(h=m.value,g=V(l,h.elementId,h.animationId),y=Q(h.elementId),!(!g||!y)){a.next=17;break}return a.abrupt("continue",22);case 17:try{(L=(ne=y).getAnimations)===null||L===void 0||L.call(ne).forEach(function(p){return p.cancel()})}catch(p){}y.getAttribute("data-pre-enter")==="true"&&(y.style.opacity="",y.removeAttribute("data-pre-enter")),te=he(g),re=y.animate(te,{duration:(i=g.options.durationMs)!==null&&i!==void 0?i:600,delay:(f=g.options.delayMs)!==null&&f!==void 0?f:0,easing:(I=g.options.easing)!==null&&I!==void 0?I:"ease",fill:"none"}),d.push(re);case 22:a.next=11;break;case 24:a.next=29;break;case 26:a.prev=26,a.t0=a.catch(9),u.e(a.t0);case 29:return a.prev=29,u.f(),a.finish(29);case 32:return O.current=d,a.prev=33,a.next=36,Promise.all(d.map(function(p){return p.finished.catch(function(){})}));case 36:a.next=40;break;case 38:a.prev=38,a.t1=a.catch(33);case 40:if(b.current=!1,E=(o=l.timeline)===null||o===void 0?void 0:o[w+1],E){a.next=44;break}return a.abrupt("return");case 44:E.trigger==="auto"?D(function(p){return p+1}):E.trigger==="afterDelay"?(P(),S.current=window.setTimeout(function(){return D(function(p){return p+1})},(K=E.delayMs)!==null&&K!==void 0?K:0)):($.current=!0,D(function(p){return p+1}));case 45:case"end":return a.stop()}},n,null,[[9,26,29,32],[33,38]])}));return function(){return r.apply(this,arguments)}}();(0,c.useEffect)(function(){var r;P(),T(),_();var n=l==null||(r=l.timeline)===null||r===void 0?void 0:r[w];if(!(!l||!n)){if(q(),n.trigger==="auto")x();else if(n.trigger==="afterDelay"){var e;S.current=window.setTimeout(function(){return x()},(e=n.delayMs)!==null&&e!==void 0?e:0)}else $.current=!0;return function(){P(),T(),_()}}},[l==null?void 0:l.id]);var ee=function(){var n;if(!b.current){var e=l==null||(n=l.timeline)===null||n===void 0?void 0:n[w];e&&e.trigger==="onClick"&&$.current&&x()}};return(0,c.useEffect)(function(){var r=function(e){(e.key===" "||e.key==="Enter")&&(e.preventDefault(),ee()),e.key==="ArrowUp"||e.key==="PageUp"?(e.preventDefault(),Y()):(e.key==="ArrowDown"||e.key==="PageDown")&&(e.preventDefault(),N())};return window.addEventListener("keydown",r),function(){return window.removeEventListener("keydown",r)}},[v,w,l]),(0,G.jsx)("div",{style:{width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"black"},onClick:ee,children:l&&(0,G.jsx)(se.Z,{interactive:!1,embedded:!0,slideIndex:v,width:W,height:J,scale:ye,showBorder:!1})})},fe=ce}}]);
