"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[322],{45322:function(ne,X,l){l.d(X,{Z:function(){return _}});var Y=l(97857),P=l.n(Y),F=l(19632),S=l.n(F),N=l(5574),R=l.n(N),a=l(67294),B=l(65337),O=l(50136),G=l(89609),t=l(85893),k=function(u){var e=u.x,v=u.y,M=u.visible,I=u.onClose,E=u.onSelect,x=(0,t.jsxs)(O.Z,{onClick:function(z){var W=z.key;return E(W)},children:[(0,t.jsx)(O.Z.Item,{children:"\u590D\u5236"},"copy"),(0,t.jsx)(O.Z.Item,{children:"\u7C98\u8D34"},"paste"),(0,t.jsx)(O.Z.Item,{children:"\u5220\u9664"},"delete")]});return M?(0,t.jsx)("div",{style:{position:"fixed",left:e,top:v,zIndex:1e3},onMouseLeave:I,children:(0,t.jsx)(G.Z,{overlay:x,open:M,onOpenChange:function(z){return!z&&I()},children:(0,t.jsx)("div",{})})}):null},H=k,w=function(u){var e=u.element,v=u.isSelected,M=u.onSelect,I=(0,a.useState)(!1),E=R()(I,2),x=E[0],D=E[1],z=(0,a.useState)(!1),W=R()(z,2),j=W[0],A=W[1],q=(0,a.useState)({x:0,y:0}),g=R()(q,2),T=g[0],K=g[1],J=(0,a.useState)({x:0,y:0,width:0,height:0,left:0,top:0}),L=R()(J,2),n=L[0],d=L[1],$=(0,a.useState)(""),U=R()($,2),ee=U[0],te=U[1],re=(0,B.L)(),Z=re.updateElement,oe=(0,a.useCallback)(function(o){if(e.type==="text"&&v&&o.target!==o.currentTarget){o.stopPropagation();return}o.preventDefault(),o.stopPropagation(),D(!0),K({x:o.clientX,y:o.clientY}),M(e.id,o)},[e.id,e.type,v,M]),se=(0,a.useCallback)(function(o,p){o.preventDefault(),o.stopPropagation(),A(!0),te(p),d({x:o.clientX,y:o.clientY,width:e.width,height:e.height,left:e.x||e.left||0,top:e.y||e.top||0})},[e]),Q=(0,a.useCallback)(function(o){if(x){var p=o.clientX-T.x,b=o.clientY-T.y;Z(e.id,{left:(e.x||e.left||0)+p,top:(e.y||e.top||0)+b}),K({x:o.clientX,y:o.clientY})}else if(j){var m=o.clientX-n.x,y=o.clientY-n.y,r=n.width,s=n.height,c=n.left,f=n.top;switch(ee){case"top-left":r=Math.max(20,n.width-m),s=Math.max(20,n.height-y),c=n.left+(n.width-r),f=n.top+(n.height-s);break;case"top-right":r=Math.max(20,n.width+m),s=Math.max(20,n.height-y),f=n.top+(n.height-s);break;case"bottom-left":r=Math.max(20,n.width-m),s=Math.max(20,n.height+y),c=n.left+(n.width-r);break;case"bottom-right":r=Math.max(20,n.width+m),s=Math.max(20,n.height+y);break;case"top-center":s=Math.max(20,n.height-y),f=n.top+(n.height-s);break;case"bottom-center":s=Math.max(20,n.height+y);break;case"left-center":r=Math.max(20,n.width-m),c=n.left+(n.width-r);break;case"right-center":r=Math.max(20,n.width+m);break}Z(e.id,{width:r,height:s,left:c,top:f})}},[x,j,T,n,ee,e.id,e.x,e.left,e.y,e.top,Z]),V=(0,a.useCallback)(function(){D(!1),A(!1),te("")},[]);(0,a.useEffect)(function(){if(x||j)return document.addEventListener("mousemove",Q),document.addEventListener("mouseup",V),function(){document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",V)}},[x,j,Q,V]);var le=function(){var p,b,m,y=e.content||"circle",r=((p=e.style)===null||p===void 0?void 0:p.fill)||"#4096ff",s=((b=e.style)===null||b===void 0?void 0:b.stroke)||"#1677ff",c=((m=e.style)===null||m===void 0?void 0:m.strokeWidth)||2,f={width:"100%",height:"100%"};switch(y){case"circle":return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:r,stroke:s,strokeWidth:c})});case"triangle":return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("polygon",{points:"50,10 90,80 10,80",fill:r,stroke:s,strokeWidth:c})});case"diamond":return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("polygon",{points:"50,10 90,50 50,90 10,50",fill:r,stroke:s,strokeWidth:c})});case"star":return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("polygon",{points:"50,5 61,35 95,35 68,57 79,91 50,70 21,91 32,57 5,35 39,35",fill:r,stroke:s,strokeWidth:c})});case"arrow-right":return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("polygon",{points:"10,20 10,80 70,80 70,90 90,50 70,10 70,20",fill:r,stroke:s,strokeWidth:c})});case"hexagon":return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("polygon",{points:"25,15 75,15 90,50 75,85 25,85 10,50",fill:r,stroke:s,strokeWidth:c})});case"heart":return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("path",{d:"M50,85 C50,85 20,60 20,40 C20,25 30,15 45,15 C47,15 50,20 50,20 C50,20 53,15 55,15 C70,15 80,25 80,40 C80,60 50,85 50,85 Z",fill:r,stroke:s,strokeWidth:c})});case"pentagon":return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("polygon",{points:"50,10 90,35 75,85 25,85 10,35",fill:r,stroke:s,strokeWidth:c})});default:return(0,t.jsx)("svg",{style:f,viewBox:"0 0 100 100",preserveAspectRatio:"none",children:(0,t.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:r,stroke:s,strokeWidth:c})})}},ie=function(){var p,b,m,y,r,s,c,f={width:"100%",height:"100%",border:"none",outline:"none",background:"transparent"};switch(e.type){case"text":return(0,t.jsx)("div",{style:P()(P()({},f),{},{color:((p=e.style)===null||p===void 0?void 0:p.color)||"#000000",fontSize:((b=e.style)===null||b===void 0?void 0:b.fontSize)||16,fontWeight:((m=e.style)===null||m===void 0?void 0:m.fontWeight)||"normal",fontStyle:((y=e.style)===null||y===void 0?void 0:y.fontStyle)||"normal",textAlign:((r=e.style)===null||r===void 0?void 0:r.textAlign)||"left",display:"flex",alignItems:"center",justifyContent:((s=e.style)===null||s===void 0?void 0:s.textAlign)==="center"?"center":((c=e.style)===null||c===void 0?void 0:c.textAlign)==="right"?"flex-end":"flex-start",padding:"4px",wordBreak:"break-word",cursor:v?"text":"grab"}),contentEditable:v,suppressContentEditableWarning:!0,onBlur:function(de){Z(e.id,{content:de.target.textContent||""})},children:e.content||"Text"});case"image":return(0,t.jsx)("img",{src:e.content||"",alt:"",style:P()(P()({},f),{},{objectFit:"cover"}),draggable:!1});case"shape":return le();default:return null}},ae=function(){return v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{position:"absolute",top:-2,left:-2,right:-2,bottom:-2,border:"2px solid #1890ff",borderRadius:"2px",pointerEvents:"none"}}),[{position:"top-left",cursor:"nw-resize"},{position:"top-right",cursor:"ne-resize"},{position:"bottom-left",cursor:"sw-resize"},{position:"bottom-right",cursor:"se-resize"},{position:"top-center",cursor:"n-resize"},{position:"bottom-center",cursor:"s-resize"},{position:"left-center",cursor:"w-resize"},{position:"right-center",cursor:"e-resize"}].map(function(p){var b=p.position,m=p.cursor;return(0,t.jsx)("div",{style:P()({position:"absolute",width:8,height:8,backgroundColor:"#1890ff",border:"1px solid #ffffff",borderRadius:"1px",cursor:m},ue(b)),onMouseDown:function(r){return se(r,b)}},b)})]}):null},ue=function(p){switch(p){case"top-left":return{top:-4,left:-4};case"top-right":return{top:-4,right:-4};case"bottom-left":return{bottom:-4,left:-4};case"bottom-right":return{bottom:-4,right:-4};case"top-center":return{top:-4,left:"50%",transform:"translateX(-50%)"};case"bottom-center":return{bottom:-4,left:"50%",transform:"translateX(-50%)"};case"left-center":return{left:-4,top:"50%",transform:"translateY(-50%)"};case"right-center":return{right:-4,top:"50%",transform:"translateY(-50%)"};default:return{}}};return(0,t.jsxs)("div",{style:{position:"absolute",left:e.x||e.left,top:e.y||e.top,width:e.width,height:e.height,transform:e.rotation?"rotate(".concat(e.rotation,"deg)"):"none",cursor:x?"grabbing":j?"resizing":e.type==="text"&&v?"text":"grab",userSelect:e.type==="text"&&v?"text":"none",zIndex:v?1e3:1},onMouseDown:oe,children:[ie(),ae()]})},i=w,h=function(){var u,e,v=(0,a.useRef)(null),M=(0,a.useState)({x:0,y:0,visible:!1}),I=R()(M,2),E=I[0],x=I[1],D=(0,B.L)(),z=D.slides,W=D.currentSlideIndex,j=D.selectedElementIds,A=D.setSelectedElementIds,q=D.updateElement,g=z[W],T=(0,a.useCallback)(function(d){d.target===d.currentTarget&&A([])},[A]),K=(0,a.useCallback)(function(d){d.preventDefault(),x({x:d.clientX,y:d.clientY,visible:!0})},[]),J=(0,a.useCallback)(function(d,$){$.stopPropagation(),$.ctrlKey||$.metaKey?j.includes(d)?A(j.filter(function(U){return U!==d})):A([].concat(S()(j),[d])):A([d])},[j,A]),L=(0,a.useCallback)(function(){x(P()(P()({},E),{},{visible:!1}))},[E]),n=(0,a.useCallback)(function(d){L()},[L]);return(0,t.jsx)("div",{style:{height:"calc(100vh - 80px)",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,t.jsxs)("div",{ref:v,className:"canvas-container",style:{position:"relative",width:"80%",height:"80%",border:"1px solid #e5e7eb",backgroundColor:(g==null||(u=g.background)===null||u===void 0?void 0:u.color)||"#ffffff",backgroundImage:g!=null&&(e=g.background)!==null&&e!==void 0&&e.image?"url(".concat(g.background.image,")"):"none",backgroundSize:"cover",backgroundPosition:"center",overflow:"hidden",cursor:"default"},onClick:T,onContextMenu:K,children:[g==null?void 0:g.elements.map(function(d){return(0,t.jsx)(i,{element:d,isSelected:j.includes(d.id),onSelect:J},d.id)}),(0,t.jsx)(H,{x:E.x,y:E.y,visible:E.visible,onClose:L,onSelect:n})]})})},_=h},65337:function(ne,X,l){l.d(X,{L:function(){return t}});var Y=l(13769),P=l.n(Y),F=l(97857),S=l.n(F),N=l(19632),R=l.n(N),a=l(3341),B=l(23184),O=l(76562),G=["left","top"],t=(0,a.U)()((0,O.O)(function(k,H){return{slides:[{id:(0,B.Z)(),elements:[]}],currentSlideIndex:0,selectedElementIds:[],addSlide:function(){k(function(i){return{slides:[].concat(R()(i.slides),[{id:(0,B.Z)(),elements:[]}]),currentSlideIndex:i.slides.length}})},deleteSlide:function(i){k(function(h){return{slides:h.slides.filter(function(_,C){return C!==i}),currentSlideIndex:h.currentSlideIndex>=i?Math.max(0,h.currentSlideIndex-1):h.currentSlideIndex}})},setCurrentSlideIndex:function(i){k({currentSlideIndex:i,selectedElementIds:[]})},updateCurrentSlide:function(i){k(function(h){return{slides:h.slides.map(function(_,C){return C===h.currentSlideIndex?S()(S()({},_),i):_})}})},addElement:function(i){k(function(h){var _=S()(S()({},i),{},{id:(0,B.Z)(),x:i.left,y:i.top});delete _.left,delete _.top;var C=h.slides.map(function(u,e){return e!==h.currentSlideIndex?u:S()(S()({},u),{},{elements:[].concat(R()(u.elements),[_])})});return{slides:C,selectedElementIds:[_.id]}})},updateElement:function(i,h){k(function(_){return{slides:_.slides.map(function(C,u){return u!==_.currentSlideIndex?C:S()(S()({},C),{},{elements:C.elements.map(function(e){if(e.id!==i)return e;var v=h,M=v.left,I=v.top,E=P()(v,G),x=E;return M!==void 0&&(x.x=M),I!==void 0&&(x.y=I),S()(S()({},e),x)})})})}})},setSelectedElementIds:function(i){k({selectedElementIds:i})},loadState:function(i){k(i)}}}))}}]);
